{"version":3,"file":"insanity.m.js","sources":["../src/action.js","../src/store.js"],"sourcesContent":["export function createActions(getState, actions) {\n\tlet result = {};\n\tfor (let i in actions) {\n\t\tresult[i] = (...args) => handleAction(getState(), actions[i], ...args);\n\t}\n\treturn result;\n}\n\nfunction handleAction(state, action, ...args) {\n\tif (typeof action.slice === 'string') {\n\t\tlet keys = action.slice.split('.');\n\t\tlet next = extend({}, state);\n\t\tlet last = next;\n\n\t\tfor (let i = 0, l = keys.length, temp; i < l; ++i) {\n\t\t\tlet isFinal = i === l - 1;\n\t\t\ttemp = extend(\n\t\t\t\tisFinal && typeof last[keys[i]].pop === 'function' ? [] : {},\n\t\t\t\tlast[keys[i]]\n\t\t\t);\n\t\t\tlast = last[keys[i]] = isFinal\n\t\t\t\t? extend(temp, action(...args, temp))\n\t\t\t\t: temp;\n\t\t}\n\n\t\treturn next;\n\t}\n\n\treturn extend({}, extend(state, action(...args, state)));\n}\n\nfunction extend(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn obj;\n}\n","export function createStore(state) {\n\tlet subs = [];\n\tstate = state || {};\n\n\tfunction removeListener(listener) {\n\t\tlet next = [];\n\t\tfor (let i = 0, l = subs.length; i < l; ++i) {\n\t\t\tlistener === subs[i] ? (listener = null) : next.push(subs[i]);\n\t\t}\n\t\tsubs = next;\n\t}\n\n\treturn {\n\t\tgetState: () => state,\n\t\tsetState: next => {\n\t\t\tif (state === next) return;\n\t\t\tstate = next;\n\t\t\tlet current = subs;\n\t\t\tfor (let i = 0, l = current.length; i < l; ++i) current[i](state);\n\t\t},\n\t\tsubscribe: listener => {\n\t\t\tsubs.push(listener);\n\t\t\treturn () => removeListener(listener);\n\t\t},\n\t};\n}\n"],"names":["createActions","getState","actions","let","result","i","state","action","slice","keys","split","next","extend","last","l","length","temp","isFinal","pop","args","obj","props","createStore","subs","setState","current","subscribe","listener","push","removeListener"],"mappings":"AAAO,SAASA,EAAcC,EAAUC,GACvCC,IAAIC,mBAEHA,EAAOC,4EAKT,SAAsBC,EAAOC,kEAC5B,GAA4B,iBAAjBA,EAAOC,MAAoB,CAKrC,IAJAL,IAAIM,EAAOF,EAAOC,MAAME,MAAM,KAC1BC,EAAOC,KAAWN,GAClBO,EAAOF,EAEFN,EAAI,EAAGS,EAAIL,EAAKM,OAAQC,SAAMX,EAAIS,IAAKT,EAAG,CAClDF,IAAIc,EAAUZ,IAAMS,EAAI,EACxBE,EAAOJ,EACNK,GAAwC,mBAAtBJ,EAAKJ,EAAKJ,IAAIa,UAChCL,EAAKJ,EAAKJ,KAEXQ,EAAOA,EAAKJ,EAAKJ,IAAMY,EACpBL,EAAOI,EAAMT,aAAO,EAAGY,UAAMH,MAC7BA,EAGJ,OAAOL,EAGR,OAAOC,KAAWA,EAAON,EAAOC,aAAO,EAAGY,UAAMb,sBAzBTL,IAAYC,EAAQG,WAAOc,MADlE,IAAKhB,IAAIE,KAAKH,OAGd,OAAOE,EA0BR,SAASQ,EAAOQ,EAAKC,GACpB,IAAKlB,IAAIE,KAAKgB,EAAOD,EAAIf,GAAKgB,EAAMhB,GACpC,OAAOe,ECjCD,SAASE,EAAYhB,GAC3BH,IAAIoB,KAWJ,OAVAjB,EAAQA,OAWPL,2BAAgBK,GAChBkB,kBAAUb,GACT,GAAIL,IAAUK,EAAd,CACAL,EAAQK,EAER,IADAR,IAAIsB,EAAUF,EACLlB,EAAI,EAAGS,EAAIW,EAAQV,OAAQV,EAAIS,IAAKT,EAAGoB,EAAQpB,GAAGC,KAE5DoB,mBAAWC,GAEV,OADAJ,EAAKK,KAAKD,qBAjBZ,SAAwBA,GAEvB,IADAxB,IAAIQ,KACKN,EAAI,EAAGS,EAAIS,EAAKR,OAAQV,EAAIS,IAAKT,EACzCsB,IAAaJ,EAAKlB,GAAMsB,EAAW,KAAQhB,EAAKiB,KAAKL,EAAKlB,IAE3DkB,EAAOZ,EAaOkB,CAAeF"}